# 题目
下载附件后得到两文件：rsappend.py 和 result

# 思路分析
阅读rsappend.py文件，了解其功能为：n为固定的，每次会用不同的e生成c，这个就像是共模攻击。了解这个就好办了，可以套用之前的算法[xgm.md](https://github.com/haozipang/JarvisOJ_CTF_Practice/blob/master/crypto/xgm.md)进行解答。
```
flag = open("flag", "r").read().strip()
assert len(flag) == 32

import primefac
import random
from os import urandom
def genprime(l):
    l/=8
    big=1
    while(l):
        big=big<<8
        l-=1
    big-=1
    small=(big+1)>>4
    temp=random.randint(small,big)
    return primefac.nextprime(temp)
def str2num(s):
    return int(s.encode('hex'), 16)
def padding(s):
    return s+urandom(abs(256-len(s)))

def rsappend(m):
    p = genprime(2048)
    q = genprime(2048)
    n = p * q
    result=[str(n)+"\n"]
    pm=padding(m)
    for i in range(32):
        e=genprime(32)
        c=pow(str2num(pm),e,n)
        result.append(str(e)+"###"+str(c)+"\n")
    return "".join(result)
    
open("result","w").write(rsappend(flag))
```

从result文件中获取n和任意两个e及对应的c值，填充至算法中，得到结果：
```
#-*- coding:utf-8 -*-
import binascii
import gmpy2
e1 = 3493354673
e2 = 340864687
a = gmpy2.gcdext(e1, e2)   # 拓展欧里几德算法
r = int(a[1])
s = int(a[2])

c1 = 95302089605615051645253770338205531172677353498946580682786822045513597212422921981567826452072575982096979591435896082106066368909398510427324124083956090397824543655853708684901332136907086372208856759943292176759073194584568350898675282883285945088425893961769183074018286761903249180704401358403273776903672507958464947244563165564687651203497198317095965140433811056890812018746508121991041040929574993486548175817290824525606551459788553765629416110310419007396912225733599205599864440826319234419035248234403040065378375700430311931418759746223148198205862641252459687694589780856855757703678024583642215076094232444641853081607984934672271461513190437757388818064739151861157236855430066735235471068167602037785718403200529481153399754491247323829122718485697100562237822159608309949585990842201041193231738706398444530233533281604482892716292766323711237917277799500317596333142843576977429802405873159965636003943698854699972663575602383960580472190300576561953143218321528070200681456278974433060654128626428761278953024384187213765974659768657721533448706022075747036347982370028705538843276631102928500802573434484354218539824751579164697748967608238067706842975984077663380114254296902060435479795741671231918448537178
c2 = 105918022590727868761989308441554006325741233318901416621101439141134508212362387984949614887131575960019253866892976283979646611794365370050551871112439674346802340152058463892106629344277362169322187627579360245792142005899616101515519718660483000821415412306495286717542069436530262341500852884860324349096274655178057271529986597578695272732947460673640986877589225588415523871081101162696385279491410034057376225511693022693861779342120101749193614060384925056132593068290214170342896671210026723193650534803792328917982049779674425511275821311773130342656939142955431868128759911406827872932920704284125816103225607727270365652734742083302757644298457617564597237089509337896240249999242834787525341715546373108420197569425092674224333823552432226153066667988737348643469923827028254712179077001007265954488404167147591307425224250970874724864947175449960116685682348915647317191880538777148647712260093008241728509225817352093441924045801257015598517963598799676359095235231066752986688784477694024390356904157694178691411759003004184256950519184836209393583431328640341243629167223114681734264945594931213193459079614652400888215324779908031661350565230685273639666615465296133672907093946148188967451042301308884510424218096
N = 130129008900473203968454456805638875182255844172836031362469765750555629223299054613072677100571707156698316733582683118539756860001556017029333867329591302318262912728008327902112481960175532302595162289611406978353816368008691640641366763939266242207191229240305820321249712345088877729541037319788659353057396178127928848886417880913823432701577855911982710310391664759040416918636673098245499680559140960154217578440590540485803953844560093151975252604098243460784073934982164384904788470380402066708313893480356219937915540825156266934523595689350157227336528136089157698775968997579723271988825396396444999743016035145444220925369592263295741687879468786947998534483539986779457827253891091252408156073413533385415338751818544323853074296042153599429749378847870780593975579477549218822682233583377677693108437331184962345568217859524495625257015837972947971787321584159575618388588687948368216479955807108888453821700067186732627409832722329355336479016104249514839541606562090752437124270651936485389358065775555250883907067083447197860848471728871909151915883316674512739238840179296263390441457949281128267215916340163366686542160467601357340644950755337706786366316621293666173843528346692669268972961669116101104865152273
m = (gmpy2.powmod(c1, r, N)*gmpy2.powmod(c2, s, N)) % N      # 计算明文，计算出的明文为16进制形式
flag = hex(m)
flag = binascii.a2b_hex(flag[2:]) # 将十六进制数字字符串转换为二进制数据（字符切片截取0x之后的）
print(flag)
```
结果为：b'`flag{we_do_ctf_together_for_fun}`\\gK\xef\x92m7\xbe\xb6\x19\xa8\x19\xf2\xb2\x18a\xeb\xc5\x9a3\xc3\x96\xbem+\xc5\xda3\x1e\x82\x98\'\xd3\xe2\xd5\x18R\x0b\x95\x88\xe6\nPo6\x97\xe0q\xf7cMK\tR\xf55\xe4\xcc\xb1\x13\x13\x17v\x16Rs\xfe\x16Q\x9c2+\x82\x82 \xda\xff\x8d\x83\x03\xf9\x1fN\xb8\x89!\xb2HA\x16y@\x9a\xf9\xe9\x13\x07\x15\x94a.I\x12\xc5\x10\x16\x10v\\\xc2\xda\xfa\xb1\xa1\x19\x92\x12\x1e\xe72\x98\x84\xc5\x04l\ns\xc8\xac\xdc\x9b\xf6\x11$\xb8"IH\xcb,V-~\xa5E\xb4\xe9\x00\xb0\xaa\x00Y\xfa\xdcUG\xf8\xc7e\xd49gu\x0f\x80w\xe0\xef\x06\x1e\xb8\xbe\x88\xd3\x81_1\xb9\xa5\xff=EiN\x80\x16\xca\xcaJ(\xe9\xe1\x0b;\xcf\xcc\xdc\xc2x\x02\'p\xda\xbdW\xa4\x99\x13\x8b*\xa0\x04?\x8bt\n\xd6\x9a\x06E\x01\x9e\xc9\x9a'
